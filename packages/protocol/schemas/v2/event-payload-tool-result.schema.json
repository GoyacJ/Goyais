{
  "$id": "goyais.protocol.v2.event-payload-tool-result",
  "type": "object",
  "required": ["call_id", "ok", "trace_id"],
  "properties": {
    "call_id": { "type": "string", "minLength": 1 },
    "ok": { "type": "boolean" },
    "output": {},
    "error": { "$ref": "goyais.protocol.v2.goyais-error" },
    "trace_id": { "type": "string", "minLength": 1 }
  },
  "allOf": [
    {
      "if": {
        "properties": { "ok": { "const": true } },
        "required": ["ok"]
      },
      "then": {
        "required": ["output"],
        "not": { "required": ["error"] }
      }
    },
    {
      "if": {
        "properties": { "ok": { "const": false } },
        "required": ["ok"]
      },
      "then": {
        "required": ["error"],
        "not": { "required": ["output"] }
      }
    }
  ],
  "additionalProperties": false
}
